"use strict";(self.webpackChunkecommerce_frontend=self.webpackChunkecommerce_frontend||[]).push([[665],{9665:(e,t,c)=>{c.r(t),c.d(t,{default:()=>m});var s=c(5043),a=c(5016),n=c(8045),r=c(2555),o=c(6274),i=c(4258),d=c(579);const l=e=>{let{product:t,categories:c=[],onSave:l,onCancel:u,isEdit:m=!1}=e;const{makeAuthenticatedRequest:h}=(0,a.A)(),{showToast:p}=(0,n.Y6)(),[x,j]=(0,s.useState)("existing"),[g,S]=(0,s.useState)("");return(0,d.jsx)("div",{className:"product-form-overlay",children:(0,d.jsx)("div",{className:"product-form-container",children:(0,d.jsxs)("div",{className:"product-form",children:[(0,d.jsx)("h3",{children:m?"Edit Product":"Add New Product"}),(0,d.jsxs)(o.A,{onSubmit:async(e,c)=>{try{const s=m?"".concat({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_BASE_URL,"/admin/products/").concat(t._id):"".concat({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_BASE_URL,"/products"),a=m?"PUT":"POST",n=(0,r.A)((0,r.A)({},e),{},{price:parseFloat(e.price),stock:parseInt(e.stock),category:"existing"===x?e.category:g});if(m)await h(s,{method:a,body:JSON.stringify(n)});else{const e=await i.iN.makeSecureRequest(s,{method:a,headers:{"X-CSRF-Token":c},body:JSON.stringify(n)});if(!e.ok){const t=await e.json();throw new Error(t.detail||"Failed to save product")}}p(m?"Product updated successfully":"Product added successfully","success"),l()}catch(s){throw s}},validate:!0,children:[(0,d.jsx)("label",{htmlFor:"name",children:"Product Name:"}),(0,d.jsx)("input",{type:"text",name:"name",placeholder:"Product Name",defaultValue:(null==t?void 0:t.name)||"",minLength:"1",maxLength:"200",required:!0}),(0,d.jsx)("label",{htmlFor:"description",children:"Description:"}),(0,d.jsx)("textarea",{name:"description",placeholder:"Product Description (min 10 characters)",defaultValue:(null==t?void 0:t.description)||"",minLength:"10",maxLength:"2000",required:!0}),(0,d.jsx)("label",{htmlFor:"price",children:"Price:"}),(0,d.jsx)("input",{type:"number",step:"0.01",min:"0.01",max:"999999.99",name:"price",placeholder:"Price",defaultValue:(null==t?void 0:t.price)||"",required:!0}),(0,d.jsxs)("div",{className:"category-section",children:[(0,d.jsx)("label",{children:"Category Selection:"}),(0,d.jsxs)("select",{value:x,onChange:e=>j(e.target.value),className:"category-select",children:[(0,d.jsx)("option",{value:"existing",children:"Select Existing Category"}),(0,d.jsx)("option",{value:"new",children:"Create New Category"})]}),"existing"===x?(0,d.jsxs)("select",{name:"category",defaultValue:(null==t?void 0:t.category)||"",required:!0,className:"category-select",children:[(0,d.jsx)("option",{value:"",children:"Choose Category"}),c.map((e=>(0,d.jsx)("option",{value:e,children:e},e)))]}):(0,d.jsx)("input",{type:"text",placeholder:"Enter new category (use / for subcategories)",value:g,onChange:e=>S(e.target.value),maxLength:"100",required:!0})]}),(0,d.jsx)("label",{htmlFor:"image_url",children:"Image URL:"}),(0,d.jsx)("input",{type:"url",name:"image_url",placeholder:"Image URL",defaultValue:(null==t?void 0:t.image_url)||"",maxLength:"500",required:!0}),(0,d.jsx)("label",{htmlFor:"stock",children:"Stock Quantity:"}),(0,d.jsx)("input",{type:"number",min:"0",max:"999999",name:"stock",placeholder:"Stock Quantity",defaultValue:(null==t?void 0:t.stock)||"",required:!0}),(0,d.jsxs)("div",{className:"form-actions",children:[(0,d.jsx)("button",{type:"submit",className:"btn btn-primary",children:m?"Update Product":"Add Product"}),(0,d.jsx)("button",{type:"button",onClick:u,className:"btn btn-outline",children:"Cancel"})]})]})]})})})};c(7648);const u={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_BASE_URL,m=()=>{const[e,t]=(0,s.useState)([]),[c,r]=(0,s.useState)([]),[o,i]=(0,s.useState)(!0),[m,h]=(0,s.useState)(null),[p,x]=(0,s.useState)(!1),{makeAuthenticatedRequest:j}=(0,a.A)(),{showToast:g}=(0,n.Y6)();(0,s.useEffect)((()=>{S(),_()}),[]);const S=async()=>{try{const e=await j("".concat(u,"/admin/products"));t(e.products||[])}catch(e){}finally{i(!1)}},_=async()=>{try{var e;const t=(null===(e=(await j("".concat(u,"/admin/categories"))).categories)||void 0===e?void 0:e.map((e=>e.name)).sort())||[];r(t)}catch(t){}},v=()=>{x(!1),h(null)};return o?(0,d.jsx)("div",{className:"container",children:(0,d.jsx)("p",{children:"Loading products..."})}):(0,d.jsx)("div",{className:"admin-products",children:(0,d.jsxs)("div",{className:"container",children:[(0,d.jsxs)("div",{className:"products-header",children:[(0,d.jsx)("h1",{children:"Product Management"}),(0,d.jsx)("button",{onClick:()=>{h(null),x(!0)},className:"btn btn-primary",children:"Add New Product"})]}),p&&(0,d.jsx)(l,{categories:c,onSave:()=>{v(),S(),_()},onCancel:v}),m&&(0,d.jsx)(l,{product:m,categories:c,onSave:()=>{v(),S(),_()},onCancel:v,isEdit:!0}),(0,d.jsx)("div",{className:"products-grid",children:e.map((e=>(0,d.jsxs)("div",{className:"admin-product-card",children:[(0,d.jsx)("img",{src:e.image_url,alt:e.name}),(0,d.jsxs)("div",{className:"product-info",children:[(0,d.jsx)("h3",{children:e.name}),(0,d.jsx)("p",{className:"description",children:e.description}),(0,d.jsxs)("p",{children:[(0,d.jsx)("strong",{children:"Price:"})," $",e.price]}),(0,d.jsxs)("p",{children:[(0,d.jsx)("strong",{children:"Category:"})," ",e.category]}),(0,d.jsxs)("p",{className:"stock ".concat(e.stock<10?"low-stock":""),children:[(0,d.jsx)("strong",{children:"Stock:"})," ",e.stock,e.stock<10&&" ⚠️"]})]}),(0,d.jsxs)("div",{className:"product-actions",children:[(0,d.jsx)("button",{onClick:()=>(e=>{x(!1),h(e)})(e),className:"btn btn-outline",children:"Edit"}),(0,d.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this product?"))try{await j("".concat(u,"/admin/products/").concat(e),{method:"DELETE"}),g("Product deleted successfully","success"),S(),_()}catch(t){g("Failed to delete product","error")}})(e._id),className:"btn btn-danger",children:"Delete"})]})]},e._id)))}),0===e.length&&(0,d.jsx)("div",{className:"no-products",children:(0,d.jsx)("p",{children:"No products found."})})]})})}}}]);
//# sourceMappingURL=665.139004ed.chunk.js.map