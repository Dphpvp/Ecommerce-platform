"use strict";(self.webpackChunkecommerce_frontend=self.webpackChunkecommerce_frontend||[]).push([[250],{5869:(e,s,a)=>{a.r(s),a.d(s,{default:()=>u});var r=a(2555),t=a(5043),i=a(5475),o=a(8045),n=a(5170),c=a(4258),l=a(7776),d=(a(5436),a(579));const m={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_BASE_URL,u=()=>{const[e]=(0,i.ok)(),s=e.get("token"),{showToast:a}=(0,o.Y6)(),[u,h]=(0,t.useState)(s?"reset":"request"),[p,w]=(0,t.useState)(!1),[x,f]=(0,t.useState)(!1),[y,g]=(0,t.useState)(null),P=(0,t.useRef)(null),[j,v]=(0,t.useState)({email:""}),[S,N]=(0,t.useState)({password:"",confirmPassword:""}),[_,E]=(0,t.useState)({});(0,t.useEffect)((()=>{if("request"!==u)return;(async()=>{try{await n.A.initialize({siteKey:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_RECAPTCHA_SITE_KEY,onLoad:()=>f(!0),onComplete:e=>{},onExpired:()=>{a("Security verification expired. Please complete it again.","warning")}})}catch(e){a("Failed to load security verification. Please refresh the page.","error")}})()}),[u,a]),(0,t.useEffect)((()=>{if(x&&"request"===u&&P.current&&!y)try{const e=n.A.render(P.current,{sitekey:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_RECAPTCHA_SITE_KEY,callback:e=>{},"expired-callback":()=>{a("Security verification expired. Please complete it again.","warning")}});g(e)}catch(e){a("Failed to load security verification. Please refresh the page.","error")}}),[x,u,a]);const T=e=>{N((0,r.A)((0,r.A)({},S),{},{[e.target.name]:e.target.value})),_[e.target.name]&&E((0,r.A)((0,r.A)({},_),{},{[e.target.name]:""}))},A=async e=>{if(e.preventDefault(),(()=>{const e={};return S.password?S.password.length<6&&(e.password="Password must be at least 6 characters"):e.password="Password is required",S.confirmPassword?S.password!==S.confirmPassword&&(e.confirmPassword="Passwords do not match"):e.confirmPassword="Please confirm your password",E(e),0===Object.keys(e).length})()){w(!0);try{const e=await fetch("".concat(m,"/auth/reset-password"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:s,new_password:S.password})}),r=await e.json();e.ok?(a("Password reset successfully! You can now login.","success"),h("success")):a(r.detail||"Failed to reset password","error")}catch(r){a("Network error. Please try again.","error")}finally{w(!1)}}};return"sent"===u?(0,d.jsx)("div",{className:"auth-page",children:(0,d.jsx)("div",{className:"container",children:(0,d.jsxs)("div",{className:"auth-form",children:[(0,d.jsx)("h1",{children:"Check Your Email"}),(0,d.jsxs)("div",{className:"success-message",children:[(0,d.jsxs)("p",{children:["We've sent a password reset link to ",(0,d.jsx)("strong",{children:j.email})]}),(0,d.jsx)("p",{children:"Check your inbox and click the link to reset your password."})]}),(0,d.jsx)(i.N_,{to:"/login",className:"btn btn-primary",style:{display:"inline-block",padding:"12px 30px",textDecoration:"none",borderRadius:"6px",fontWeight:"bold"},children:"Back to Login"})]})})}):"success"===u?(0,d.jsx)("div",{className:"auth-page",children:(0,d.jsx)("div",{className:"container",children:(0,d.jsxs)("div",{className:"auth-form",children:[(0,d.jsx)("h1",{children:"Password Reset Complete"}),(0,d.jsx)("div",{className:"success-message",children:(0,d.jsx)("p",{children:"Your password has been successfully reset!"})}),(0,d.jsx)(i.N_,{to:"/login",className:"btn btn-primary",children:"Login with New Password"})]})})}):"reset"===u&&s?(0,d.jsx)("div",{className:"auth-page",children:(0,d.jsx)("div",{className:"container",children:(0,d.jsxs)("div",{className:"auth-form",children:[(0,d.jsx)("h1",{children:"Reset Your Password"}),(0,d.jsxs)("form",{onSubmit:A,children:[(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("input",{type:"password",name:"password",placeholder:"New Password (min 6 characters)",value:S.password,onChange:T,className:_.password?"error":"",required:!0}),_.password&&(0,d.jsx)("span",{className:"error-text",children:_.password})]}),(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("input",{type:"password",name:"confirmPassword",placeholder:"Confirm New Password",value:S.confirmPassword,onChange:T,className:_.confirmPassword?"error":"",required:!0}),_.confirmPassword&&(0,d.jsx)("span",{className:"error-text",children:_.confirmPassword})]}),(0,d.jsx)("button",{type:"submit",disabled:p,className:"btn btn-primary",children:p?"Resetting...":"Reset Password"})]}),(0,d.jsx)("p",{children:(0,d.jsx)(i.N_,{to:"/login",children:"Back to Login"})})]})})}):(0,d.jsx)("div",{className:"auth-page",children:(0,d.jsx)("div",{className:"container",children:(0,d.jsxs)("div",{className:"auth-form",children:[(0,d.jsx)("h1",{children:"Reset Password"}),(0,d.jsx)("p",{children:"Enter your email address and we'll send you a link to reset your password."}),!x&&(0,d.jsx)("div",{className:"loading-recaptcha",style:{margin:"10px 0"},children:(0,d.jsx)("p",{style:{color:"#666",fontSize:"0.9rem"},children:"Loading security verification..."})}),(0,d.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),!j.email)return void E({email:"Email is required"});let s="";try{s=n.A.getResponse(y)}catch(o){}if(!s){const e="Please complete the security verification";return E({captcha:e}),void await l.A.showToast(e,3e3)}w(!0);let r=null;try{var t;r=await l.A.showLoading("Sending reset email..."),null!==(t=r)&&void 0!==t&&t.present&&await r.present();const e=await(0,c.MB)("".concat(m,"/auth/request-password-reset"),{method:"POST",body:JSON.stringify({email:j.email,recaptcha_response:s})}),i=await e.json();if(e.ok)a("Password reset email sent! Check your inbox.","success"),await l.A.showToast("Password reset email sent! Check your inbox.",3e3),h("sent");else{const e=i.detail||"Failed to send reset email";a(e,"error"),await l.A.showToast(e,3e3),null!==y&&n.A.reset(y)}}catch(o){let e="Network error. Please try again.";"TypeError"===o.name&&o.message.includes("fetch")?e="Connection failed. Please check your internet connection.":429===o.status?e="Too many requests. Please try again later.":o.status>=500&&(e="Server error. Please try again later."),a(e,"error"),await l.A.showToast(e,4e3),null!==y&&n.A.reset(y)}finally{var i;w(!1),null!==(i=r)&&void 0!==i&&i.dismiss&&await r.dismiss()}},children:[(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("input",{type:"email",name:"email",placeholder:"Enter your email address",value:j.email,onChange:e=>{v((0,r.A)((0,r.A)({},j),{},{[e.target.name]:e.target.value})),_[e.target.name]&&E((0,r.A)((0,r.A)({},_),{},{[e.target.name]:""}))},className:_.email?"error":"",required:!0}),_.email&&(0,d.jsx)("span",{className:"error-text",children:_.email})]}),(0,d.jsxs)("div",{className:"form-group",children:[(0,d.jsx)("div",{ref:P,style:{margin:"10px 0",display:"flex",justifyContent:"center"}}),!x&&(0,d.jsx)("p",{style:{color:"#666",fontSize:"0.9rem",textAlign:"center"},children:"Please wait for security verification to load..."}),_.captcha&&(0,d.jsx)("span",{className:"error-text",children:_.captcha})]}),(0,d.jsx)("button",{type:"submit",disabled:p||!x,className:"btn btn-primary",children:p?"Sending...":"Send Reset Link"})]}),(0,d.jsxs)("p",{children:["Remember your password? ",(0,d.jsx)(i.N_,{to:"/login",children:"Back to Login"})]})]})})})}}}]);
//# sourceMappingURL=250.72a74011.chunk.js.map