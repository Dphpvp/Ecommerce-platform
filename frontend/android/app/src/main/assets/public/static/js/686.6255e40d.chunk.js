"use strict";(self.webpackChunkecommerce_frontend=self.webpackChunkecommerce_frontend||[]).push([[686],{8686:(e,t,a)=>{a.r(t),a.d(t,{default:()=>i});var s=a(2555),c=a(5043),n=a(5016),r=(a(7648),a(579));const o={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_BASE_URL,i=()=>{const[e,t]=(0,c.useState)([]),[a,i]=(0,c.useState)(!0),[l,d]=(0,c.useState)(null),[u,m]=(0,c.useState)(null),[h,p]=(0,c.useState)(""),[g,x]=(0,c.useState)(""),[j,v]=(0,c.useState)(!1),[y,b]=(0,c.useState)(null),[f,N]=(0,c.useState)([]),[C,S]=(0,c.useState)(!1),[k,_]=(0,c.useState)(null),[w,A]=(0,c.useState)({}),[E,T]=(0,c.useState)(new Set),{makeAuthenticatedRequest:P}=(0,n.A)(),R=(0,c.useRef)(null);(0,c.useEffect)((()=>{O(),D()}),[]);const D=async()=>{try{const e=await P("".concat(o,"/admin/debug"));m(e)}catch(l){}},O=async()=>{try{i(!0),d(null);const e=await P("".concat(o,"/admin/categories"));t(e.categories||[])}catch(l){d(l.message),t([])}finally{i(!1)}},F=function(t){let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Object.entries(t).map((t=>{let[s,c]=t;const n=Object.keys(c.children).length>0,i=E.has(c.name),d={marginLeft:"".concat(20*a,"px")};return(0,r.jsxs)("div",{className:"category-tree-item",children:[(0,r.jsxs)("div",{className:"category-card",style:d,children:[(0,r.jsxs)("div",{className:"category-header",children:[n&&(0,r.jsx)("button",{className:"expand-toggle",onClick:()=>(e=>{const t=new Set(E);t.has(e)?t.delete(e):t.add(e),T(t)})(c.name),children:i?"▼":"▶"}),(0,r.jsxs)("div",{className:"category-info",children:[(0,r.jsx)("h3",{children:s}),(0,r.jsxs)("div",{className:"category-stats",children:[(0,r.jsxs)("span",{children:["Products: ",c.data.product_count]}),(0,r.jsxs)("span",{children:["Stock: ",c.data.total_stock]})]})]})]}),(0,r.jsxs)("div",{className:"category-actions",children:[(0,r.jsx)("button",{className:"view-btn",onClick:()=>L(c.name),disabled:C,children:y===c.name?"Hide Products":"View"}),(0,r.jsx)("button",{className:"add-sub-btn",onClick:()=>x(c.name),children:"Add Sub"}),(0,r.jsx)("button",{className:"delete-btn",onClick:()=>(async t=>{var a;const s=e.filter((e=>e.name.startsWith(t+"/")||e.name===t)).length,c=(null===(a=e.find((e=>e.name===t)))||void 0===a?void 0:a.product_count)>0;let n=s>1?'Delete "'.concat(t,'" and ').concat(s-1," subcategories?"):'Delete category "'.concat(t,'"?');if(c&&(n+='\n\nProducts will be moved to "Uncategorized" category.'),window.confirm(n))try{const e=encodeURIComponent(t),a=await P("".concat(o,"/admin/categories/").concat(e),{method:"DELETE"});alert(a.message),O(),D(),y===t&&(b(null),N([]))}catch(l){alert(l.message||"Failed to delete category")}})(c.name),children:"Delete"})]})]}),n&&i&&(0,r.jsx)("div",{className:"subcategories",children:F(c.children,a+1)})]},c.name)}))},L=async e=>{if(y===e)return b(null),void N([]);S(!0);try{const t=await P("".concat(o,"/products?category=").concat(encodeURIComponent(e)));N(t),b(e),setTimeout((()=>{var e;null===(e=R.current)||void 0===e||e.scrollIntoView({behavior:"smooth",block:"start"})}),100)}catch(l){alert("Failed to load products")}finally{S(!1)}},I=()=>{_(null),A({})};return a?(0,r.jsx)("div",{className:"container",children:(0,r.jsx)("p",{children:"Loading categories..."})}):(0,r.jsx)("div",{className:"admin-categories",children:(0,r.jsxs)("div",{className:"container",children:[(0,r.jsx)("h1",{children:"Categories Management"}),u&&(0,r.jsxs)("div",{className:"debug-info",style:{backgroundColor:"#f8f9fa",padding:"1rem",marginBottom:"1rem",borderRadius:"5px",fontSize:"0.9rem"},children:[(0,r.jsx)("strong",{children:"Debug Info:"}),"Total Products: ",u.total_products||0," | Categories Found: ",e.length,u.error&&(0,r.jsxs)("div",{style:{color:"red"},children:["Error: ",u.error]})]}),l&&(0,r.jsxs)("div",{className:"error-message",style:{backgroundColor:"#f8d7da",color:"#721c24",padding:"1rem",marginBottom:"1rem",borderRadius:"5px"},children:["Error: ",l]}),(0,r.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),h.trim()){v(!0);try{await P("".concat(o,"/admin/categories"),{method:"POST",body:JSON.stringify({name:h.trim(),parent:g})});p(""),x(""),O(),D()}catch(l){alert(l.message||"Failed to create category")}finally{v(!1)}}},className:"category-form",children:[(0,r.jsxs)("div",{className:"form-row",children:[(0,r.jsxs)("select",{value:g,onChange:e=>x(e.target.value),disabled:j,children:[(0,r.jsx)("option",{value:"",children:"Root Category"}),(()=>{const t=[...new Set(e.map((e=>e.name.split("/").slice(0,-1).join("/"))).filter(Boolean))],a=e.filter((e=>!e.name.includes("/"))).map((e=>e.name));return[...new Set([...a,...t])].sort()})().map((e=>(0,r.jsx)("option",{value:e,children:e},e)))]}),(0,r.jsx)("input",{type:"text",value:h,onChange:e=>p(e.target.value),placeholder:"New category name",disabled:j}),(0,r.jsx)("button",{type:"submit",disabled:j||!h.trim(),children:j?"Creating...":"Add Category"})]}),g&&(0,r.jsxs)("p",{className:"parent-preview",children:["Creating: ",(0,r.jsxs)("strong",{children:[g,"/",h]}),(0,r.jsx)("button",{type:"button",onClick:()=>x(""),className:"clear-parent",children:"×"})]})]}),0===e.length?(0,r.jsxs)("div",{style:{textAlign:"center",padding:"2rem",backgroundColor:"#f8f9fa",borderRadius:"5px"},children:[(0,r.jsx)("h3",{children:"No categories found"}),(0,r.jsx)("p",{children:"Categories are created from existing products. You can:"}),(0,r.jsxs)("ol",{style:{textAlign:"left",display:"inline-block"},children:[(0,r.jsx)("li",{children:"Create your first category above"}),(0,r.jsx)("li",{children:"Add products in the Products section"}),(0,r.jsx)("li",{children:"Assign categories to products"})]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Tip:"}),' Create a category like "Electronics" or "Clothing" to get started.']})]}):(0,r.jsx)("div",{className:"categories-tree",children:F((()=>{const t={};return e.forEach((a=>{const s=a.name.split("/");let c=t;s.forEach(((t,a)=>{const n=s.slice(0,a+1).join("/");c[t]||(c[t]={name:n,children:{},data:e.find((e=>e.name===n))||{name:n,product_count:0,total_stock:0,level:a}}),c=c[t].children}))})),t})())}),y&&(0,r.jsxs)("div",{className:"products-section",ref:R,children:[(0,r.jsxs)("h2",{children:['Products in "',y,'" Category']}),C?(0,r.jsx)("p",{children:"Loading products..."}):0===f.length?(0,r.jsx)("p",{children:"No products found in this category."}):(0,r.jsx)("div",{className:"products-grid",children:f.map((e=>(0,r.jsx)("div",{className:"product-card",children:k===e._id?(0,r.jsxs)("div",{className:"edit-form",children:[(0,r.jsx)("input",{type:"text",value:w.name,onChange:e=>A((0,s.A)((0,s.A)({},w),{},{name:e.target.value})),placeholder:"Product name"}),(0,r.jsx)("textarea",{value:w.description,onChange:e=>A((0,s.A)((0,s.A)({},w),{},{description:e.target.value})),placeholder:"Description",rows:"3"}),(0,r.jsx)("input",{type:"number",step:"0.01",value:w.price,onChange:e=>A((0,s.A)((0,s.A)({},w),{},{price:parseFloat(e.target.value)})),placeholder:"Price"}),(0,r.jsx)("input",{type:"number",value:w.stock,onChange:e=>A((0,s.A)((0,s.A)({},w),{},{stock:parseInt(e.target.value)})),placeholder:"Stock"}),(0,r.jsx)("input",{type:"url",value:w.image_url,onChange:e=>A((0,s.A)((0,s.A)({},w),{},{image_url:e.target.value})),placeholder:"Image URL"}),(0,r.jsxs)("div",{className:"edit-actions",children:[(0,r.jsx)("button",{className:"save-btn",onClick:()=>(async e=>{try{await P("".concat(o,"/admin/products/").concat(e),{method:"PUT",body:JSON.stringify(w)}),L(y),O(),_(null),A({})}catch(l){alert("Failed to update product")}})(e._id),children:"Save"}),(0,r.jsx)("button",{className:"cancel-btn",onClick:I,children:"Cancel"})]})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("img",{src:e.image_url,alt:e.name}),(0,r.jsx)("h4",{children:e.name}),(0,r.jsxs)("p",{className:"price",children:["$",e.price]}),(0,r.jsxs)("p",{className:"stock",children:["Stock: ",e.stock]}),(0,r.jsx)("p",{className:"description",children:e.description}),(0,r.jsxs)("div",{className:"product-actions",children:[(0,r.jsx)("button",{className:"edit-btn",onClick:()=>(e=>{_(e._id),A({name:e.name,description:e.description,price:e.price,stock:e.stock,image_url:e.image_url})})(e),children:"Edit"}),(0,r.jsx)("button",{className:"delete-product-btn",onClick:()=>(async(e,t)=>{if(window.confirm('Delete product "'.concat(t,'"?')))try{await P("".concat(o,"/admin/products/").concat(e),{method:"DELETE"}),L(y),O(),D()}catch(l){alert("Failed to delete product")}})(e._id,e.name),children:"Delete"})]})]})},e._id)))}),(0,r.jsx)("div",{className:"scroll-controls",children:(0,r.jsx)("button",{className:"scroll-to-top",onClick:()=>window.scrollTo({top:0,behavior:"smooth"}),children:"↑ Back to Top"})})]})]})})}}}]);
//# sourceMappingURL=686.6255e40d.chunk.js.map